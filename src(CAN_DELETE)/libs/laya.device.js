!function(t,e){"use strict";class a{constructor(){}}class n{constructor(){}}class i extends e.EventDispatcher{static get instance(){return i._instance=i._instance||new i,i._instance}constructor(){super(),this.onDeviceOrientationChange=this.onDeviceOrientationChange.bind(this)}onStartListeningToType(t){return t==e.Event.CHANGE&&e.ILaya.Browser.window.addEventListener("devicemotion",this.onDeviceOrientationChange),this}onDeviceOrientationChange(t){var a=t.interval;i.acceleration.x=t.acceleration.x,i.acceleration.y=t.acceleration.y,i.acceleration.z=t.acceleration.z,i.accelerationIncludingGravity.x=t.accelerationIncludingGravity.x,i.accelerationIncludingGravity.y=t.accelerationIncludingGravity.y,i.accelerationIncludingGravity.z=t.accelerationIncludingGravity.z,i.rotationRate.alpha=-1*t.rotationRate.gamma,i.rotationRate.beta=-1*t.rotationRate.alpha,i.rotationRate.gamma=t.rotationRate.beta,e.ILaya.Browser.onAndroid?(e.ILaya.Browser.userAgent.indexOf("Chrome")>-1&&(i.rotationRate.alpha*=180/Math.PI,i.rotationRate.beta*=180/Math.PI,i.rotationRate.gamma*=180/Math.PI),i.acceleration.x*=-1,i.accelerationIncludingGravity.x*=-1):e.ILaya.Browser.onIOS&&(i.acceleration.y*=-1,i.acceleration.z*=-1,i.accelerationIncludingGravity.y*=-1,i.accelerationIncludingGravity.z*=-1,a*=1e3),this.event(e.Event.CHANGE,[i.acceleration,i.accelerationIncludingGravity,i.rotationRate,a])}static getTransformedAcceleration(t){var n;return i.transformedAcceleration=i.transformedAcceleration||new a,i.transformedAcceleration.z=t.z,90==e.ILaya.Browser.window.orientation?(i.transformedAcceleration.x=t.y,i.transformedAcceleration.y=-t.x):-90==e.ILaya.Browser.window.orientation?(i.transformedAcceleration.x=-t.y,i.transformedAcceleration.y=t.x):e.ILaya.Browser.window.orientation?180==e.ILaya.Browser.window.orientation&&(i.transformedAcceleration.x=-t.x,i.transformedAcceleration.y=-t.y):(i.transformedAcceleration.x=t.x,i.transformedAcceleration.y=t.y),-90==e.ILaya.stage.canvasDegree?(n=i.transformedAcceleration.x,i.transformedAcceleration.x=-i.transformedAcceleration.y,i.transformedAcceleration.y=n):90==e.ILaya.stage.canvasDegree&&(n=i.transformedAcceleration.x,i.transformedAcceleration.x=i.transformedAcceleration.y,i.transformedAcceleration.y=-n),i.transformedAcceleration}}i.acceleration=new a,i.accelerationIncludingGravity=new a,i.rotationRate=new n;class o extends e.EventDispatcher{constructor(){super()}static get instance(){return o._instance=o._instance||new o,o._instance}start(t,a){this.threshold=t,this.shakeInterval=a,this.lastX=this.lastY=this.lastZ=NaN,i.instance.on(e.Event.CHANGE,this,this.onShake)}stop(){i.instance.off(e.Event.CHANGE,this,this.onShake)}onShake(t,a,n,i){if(isNaN(this.lastX))return this.lastX=a.x,this.lastY=a.y,this.lastZ=a.z,void(this.lastMillSecond=e.ILaya.Browser.now());var o=Math.abs(this.lastX-a.x),r=Math.abs(this.lastY-a.y),c=Math.abs(this.lastZ-a.z);this.isShaked(o,r,c)&&(e.ILaya.Browser.now()-this.lastMillSecond>this.shakeInterval&&(this.event(e.Event.CHANGE),this.lastMillSecond=e.ILaya.Browser.now()));this.lastX=a.x,this.lastY=a.y,this.lastZ=a.z}isShaked(t,e,a){const n=(t>this.threshold?1:0)|(e>this.threshold?2:0)|(a>this.threshold?4:0);return!!(n&n-1)}}class r{setPosition(t){this.pos=t,this.coords=t.coords}get latitude(){return this.coords.latitude}get longitude(){return this.coords.longitude}get altitude(){return this.coords.altitude}get accuracy(){return this.coords.accuracy}get altitudeAccuracy(){return this.coords.altitudeAccuracy}get heading(){return this.coords.heading}get speed(){return this.coords.speed}get timestamp(){return this.pos.timestamp}}class c{constructor(){}static getCurrentPosition(t,e=null){c.navigator.geolocation.getCurrentPosition(function(e){c.position.setPosition(e),t.runWith(c.position)},function(t){e.runWith(t)},{enableHighAccuracy:c.enableHighAccuracy,timeout:c.timeout,maximumAge:c.maximumAge})}static watchPosition(t,e){return c.navigator.geolocation.watchPosition(function(e){c.position.setPosition(e),t.runWith(c.position)},function(t){e.runWith(t)},{enableHighAccuracy:c.enableHighAccuracy,timeout:c.timeout,maximumAge:c.maximumAge})}static clearWatch(t){c.navigator.geolocation.clearWatch(t)}}c.navigator=navigator,c.position=new r,c.PERMISSION_DENIED=1,c.POSITION_UNAVAILABLE=2,c.TIMEOUT=3,c.supported=!!c.navigator.geolocation,c.enableHighAccuracy=!1,c.timeout=1e10,c.maximumAge=0;class s extends e.EventDispatcher{static get instance(){return s._instance=s._instance||new s(0),s._instance}constructor(t){super(),this.onDeviceOrientationChange=this.onDeviceOrientationChange.bind(this)}onStartListeningToType(t){return t==e.Event.CHANGE&&e.ILaya.Browser.window.addEventListener("deviceorientation",this.onDeviceOrientationChange),this}onDeviceOrientationChange(t){s.info.alpha=t.alpha,s.info.beta=t.beta,s.info.gamma=t.gamma,t.webkitCompassHeading&&(s.info.alpha=-1*t.webkitCompassHeading,s.info.compassAccuracy=t.webkitCompassAccuracy),this.event(e.Event.CHANGE,[t.absolute,s.info])}}s.info=new n,t.AccelerationInfo=a,t.Accelerator=i,t.Geolocation=c,t.GeolocationInfo=r,t.Gyroscope=s,t.Media=class{constructor(){}static supported(){return!!e.ILaya.Browser.window.navigator.getUserMedia}static getMedia(t,a,n){e.ILaya.Browser.window.navigator.getUserMedia&&e.ILaya.Browser.window.navigator.getUserMedia(t,function(t){a.runWith(e.ILaya.Browser.window.URL.createObjectURL(t))},function(t){n.runWith(t)})}},t.RotationInfo=n,t.Shake=o}(window.Laya=window.Laya||{},Laya);